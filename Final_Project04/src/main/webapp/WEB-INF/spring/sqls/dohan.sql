DROP SEQUENCE USERSEQ;
DROP TABLE USERS;


CREATE SEQUENCE USERSEQ;

CREATE TABLE USERS(
	USERSEQ NUMBER PRIMARY KEY,
	USERID VARCHAR2(100) NOT NULL,
	PASSWORD VARCHAR2(100) NOT NULL,
	USEREMAIL VARCHAR2(1000) NOT NULL,
	USERPHONE VARCHAR2(1000) NOT NULL,
	USEROADDRESS VARCHAR2(4000) NOT NULL,
	USERADDRESS VARCHAR2(4000) NOT NULL,
	USERDETAILADDRESS VARCHAR2(4000) NOT NULL,
	USERROLE VARCHAR2(100) CHECK(USERROLE IN ('admin', 'user')),
	USERNAME VARCHAR2(100) NOT NULL,
	USERBIRTHDAY VARCHAR2(100) NOT NULL
);


ALTER TABLE USERS ADD UNIQUE (USERID);

SELECT * FROM USERS;

DELETE FROM USERS WHERE USERID = 'kim1234';


SELECT * FROM PRODUCT;



DROP TABLE CHATROOM;
DROP TABLE MESSAGE;

DROP SEQUENCE MESSAGE_ID;
DROP SEQUENCE CHATROOM_ID;

CREATE SEQUENCE MESSAGE_ID;
CREATE SEQUENCE CHATROOM_ID;


CREATE TABLE MESSAGE (
   MESSAGE_ID NUMBER PRIMARY KEY,
   MESSAGE_SENDER VARCHAR2(45) NOT NULL,
   MESSAGE_RECEIVER VARCHAR2(45) NOT NULL,
   MESSAGE_CONTENT VARCHAR2(4000) NOT NULL,
   MESSAGE_REGDATE DATE NOT NULL,
   CHATROOM_ID NUMBER,
   CONSTRAINT FK_CHATROOM_ID FOREIGN KEY(CHATROOM_ID) REFERENCES CHATROOM (CHATROOM_ID)
);

SELECT * FROM ADMINPRODUCT;

CREATE TABLE CHATROOM ( 
   CHATROOM_ID NUMBER PRIMARY KEY,
   CHATROOM_BUYER VARCHAR2(100) NOT NULL,
   CHATROOM_SELLER VARCHAR2(100) NOT NULL,
   CHATROOM_TITLE VARCHAR2(100) NOT NULL,
   CHATROOM_REGDATE DATE NOT NULL,
   CONSTRAINT FK_CHATROOM_BUYER FOREIGN KEY(CHATROOM_BUYER) REFERENCES USERS (USERID)
);

ALTER TABLE CHATROOM ADD CHATROOM_TITLE VARCHAR2(100) NOT NULL;
ALTER TABLE CHATROOM ADD CHATROOM_SELLER VARCHAR2(100) NOT NULL;
ALTER TABLE CHATROOM RENAME COLUMN CREATE_CHATROOM_USER TO CHATROOM_BUYER;
ALTER TABLE MESSAGE MODIFY MESSAGE_REGDATE DATE NOT NULL;


SELECT * FROM MESSAGE;
SELECT * FROM CHATROOM;

SELECT * FROM PRODUCT
WHERE USERROLE = 'ADMIN'
ORDER BY PRODUCTPRICE DESC;



CREATE TABLE Product (
	productSeq NUMBER PRIMARY KEY NOT NULL,
	productName VARCHAR2(100) NOT NULL,
	productPrice NUMBER(30) NOT NULL,
	sellerAddress VARCHAR2(1000),
	productRegDate DATE,
	productInfo VARCHAR2(4000),
	productImg VARCHAR2(4000),
	productThumb VARCHAR2(4000),
	saleStatus VARCHAR2(20),
	userRole VARCHAR2(10) NOT NULL,
	userSeq NUMBER NOT NULL,
	userId VARCHAR2(30),
	userLatitude VARCHAR2(1000),
	userLongitude VARCHAR2(1000) 
);



CREATE SEQUENCE orderSeq;

CREATE TABLE Order (
	orderSeq PRIMARY KEY,
	productPrice NUMBER NOT NULL,
	receiveName VARCHAR2(100) NOT NULL,
	receiverOaddress VARCHAR2(4000) NOT NULL,
	receiverRaddress VARCHAR2(4000) NOT NULL,
	receiverDetailaddress VARCHAR2(4000) NOT NULL,
	quantity NUMBER NOT NULL,
	productName VARCHAR(200) NOT NULL,
	orderDate DATE NOT NULL,
	userId VARCHAR2(200) NOT NULL,
	orderAmount NUMBER NOT NULL,
	receiverPhone VARCHAR2(200) NOT NULL
	
);
